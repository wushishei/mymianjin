import{t as e}from"./request-CMp-Rt37.js";import{C as t,D as n,E as r,N as i,O as a,_ as o,b as s,c,h as l,j as u,k as d,n as f,s as p,t as m,v as h,w as g,x as _,y as v}from"./index-DPV6HfP3.js";import{t as y}from"./ArticleItem-DJTQ4cZk.js";var b={class:`home-view`},x={class:`my-nav van-hairline--bottom`},S={class:`article-list`},C={class:`load-more`},w={key:1,class:`no-data`},T=p(t({__name:`MyArticlesView`,setup(t){let p=u([]),T=u([]),E=u(!1),D=u(!1),O=(e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime(),k=()=>[...p.value].sort(O),A=e=>{E.value=e,E.value?T.value=k():T.value=[...p.value]},j=u(null),M=async()=>{try{let t=await e.get(`/auth/currentUser`,{headers:{Authorization:f()}});t.data.code===1e4&&(j.value=t.data.data,console.log(`当前用户信息:`,j.value))}catch(e){console.error(`获取用户信息失败:`,e)}},N=async()=>{try{if(D.value=!0,console.log(`开始获取我的文章`),await M(),!j.value){c(`获取用户信息失败`);return}let t=1,n=[],r=!0;for(;r;){let i=await e.get(`/h5/interview/query`,{headers:{Authorization:f()},params:{current:t,pageSize:50}});if(i.data.code===1e4){let e=i.data.data.rows;n=[...n,...e],e.length<50?r=!1:t++}else{console.error(`获取文章列表失败，错误码:`,i.data.code,`错误信息:`,i.data.message),c(`获取文章列表失败`);return}}console.log(`所有文章数据:`,n);let i=n.filter(e=>e.creator===j.value?.username);console.log(`我的文章数据:`,i),p.value=i,T.value=[...p.value]}catch(e){console.error(`获取文章异常:`,e),c(`网络错误，请重试`)}finally{D.value=!1}};g(()=>{N()});let P=e=>{m.push({name:`article`,params:{id:e}})};return(e,t)=>{let c=a(`van-loading`);return r(),s(`div`,b,[o(`nav`,x,[o(`a`,{class:i({active:!E.value}),href:`javascript:;`,onClick:t[0]||=e=>A(!1)},`推荐`,2),o(`a`,{class:i({active:E.value}),href:`javascript:;`,onClick:t[1]||=e=>A(!0)},`最新`,2),t[2]||=o(`div`,{class:`logo`},[o(`h1`,{class:`logo-text`},`我的文章`)],-1)]),o(`div`,S,[(r(!0),s(l,null,n(T.value,e=>(r(),h(y,{key:e.id,item:e,onClick:t=>P(e.id)},null,8,[`item`,`onClick`]))),128))]),o(`div`,C,[D.value?(r(),h(c,{key:0,size:`20px`,color:`#999`,vertical:``},{default:d(()=>[...t[3]||=[_(`加载中...`,-1)]]),_:1})):T.value.length===0?(r(),s(`span`,w,`暂无文章`)):v(``,!0)])])}}}),[[`__scopeId`,`data-v-f2f88a50`]]);export{T as default};