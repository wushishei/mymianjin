import{t as e}from"./request-CMp-Rt37.js";import{C as t,E as n,N as r,O as i,P as a,S as o,_ as s,a as c,b as l,d as u,f as d,g as f,j as p,k as m,n as h,t as g,w as _,y as v}from"./index-DPV6HfP3.js";import{t as y}from"./moren-DywuXjrH.js";var b=`/mymianjin/shoucang.png`,x=`/mymianjin/dianzan.png`;const S=d(`counter`,()=>{let e=p(0),t=f(()=>e.value*2);function n(){e.value++}let r=p(new Map),i=p(new Map);function a(e,t){r.value.set(e,t)}function o(e,t){i.value.set(e,t)}function s(e){let t=!r.value.get(e);return r.value.set(e,t),u(t?`收藏成功`:`取消收藏`),t}function c(e){let t=!i.value.get(e);return i.value.set(e,t),u(t?`点赞成功`:`取消点赞`),t}function l(e){return r.value.get(e)||!1}function d(e){return i.value.get(e)||!1}return{count:e,doubleCount:t,increment:n,collectStates:r,likeStates:i,initCollectState:a,initLikeState:o,toggleCollect:s,toggleLike:c,getCollectState:l,getLikeState:d}});var C={class:`article-container`},w={class:`stem`},T={class:`foot`},E={class:`article-content`},D={class:`head`},O={class:`con`},k={class:`title`},A={class:`other`},j=[`innerHTML`],M={class:`contain`},N=t({__name:`ArticleView`,setup(t){let d=S(),y=c(),N=p({}),P=p(null),F=async()=>{try{let t=await e.get(`/auth/currentUser`,{headers:{Authorization:h()}});t.data.code===1e4&&(P.value=t.data.data)}catch(e){console.error(`获取用户信息失败:`,e)}};_(async()=>{await F();let t=`?id=`+y.params.id;N.value=(await e.get(`/h5/interview/show${t}`,{headers:{Authorization:h()}})).data.data,console.log(N.value),d.initLikeState(N.value.id,N.value.likeFlag===1),d.initCollectState(N.value.id,N.value.collectFlag===1)});let I=()=>{g.back()},L=async()=>{(await e.post(`/h5/interview/opt`,{optType:2,id:N.value.id},{headers:{Authorization:h()}})).data.code===1e4?(d.toggleCollect(N.value.id),N.value.collectFlag=N.value.collectFlag===1?0:1):u(`收藏失败`)},R=async()=>{(await e.post(`/h5/interview/opt`,{optType:1,id:N.value.id},{headers:{Authorization:h()}})).data.code===1e4?(d.toggleLike(N.value.id),N.value.likeFlag===1?(N.value.likeFlag=0,N.value.likeCount--):(N.value.likeFlag=1,N.value.likeCount++)):u(`点赞失败`)},z=f(()=>d.getCollectState(N.value.id)),B=f(()=>d.getLikeState(N.value.id)),V=async()=>{try{(await e.delete(`/admin/interview/remove/`,{data:{id:y.params.id},headers:{Authorization:h()}})).data.code===1e4?(u(`删除成功`),g.push(`/my-articles`)):u(`删除失败`)}catch(e){u(`删除失败`+e)}};return(e,t)=>{let c=i(`van-nav-bar`);return n(),l(`div`,C,[o(c,{title:`面经详情`,"left-text":`返回`,"left-arrow":``,onClickLeft:I},{right:m(()=>[P.value&&N.value.id&&P.value.username===N.value.creator?(n(),l(`div`,{key:0,class:`delete-btn`,onClick:V},[...t[0]||=[s(`svg`,{width:`24`,height:`24`,viewBox:`0 0 24 24`,fill:`#ff4d4f`},[s(`path`,{d:`M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z`})],-1)]])):v(``,!0)]),_:1}),s(`div`,w,a(N.value.stem),1),s(`div`,T,`点赞 `+a(N.value.likeCount)+` | 浏览 `+a(N.value.views),1),s(`div`,E,[s(`div`,D,[t[1]||=s(`img`,{src:`/mymianjin/assets/moren-zJe3wZLf.png`,alt:``},null,-1),s(`div`,O,[s(`p`,k,a(N.value.creator),1),s(`p`,A,a(N.value.createdAt),1)])]),s(`div`,{class:`body`,innerHTML:N.value.content},null,8,j)]),s(`span`,M,[s(`img`,{class:r([{fo2:z.value,fo1:!z.value},`floating-img`]),src:b,onClick:L},null,2),s(`img`,{class:r([{fo2:B.value,fo1:!B.value},`floating-img`]),src:x,onClick:R},null,2)])])}}});export{N as default};